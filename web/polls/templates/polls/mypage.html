<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>myPage</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- bootstrap css -->
    <!-- css íŒŒì¼ ì—°ê²°-->
    <link rel="stylesheet" href="../../static/css/bootstrap.min.css" />
    <link rel="stylesheet" href="../../static/css/myPage.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css"
    />
  </head>

  <style>
    .linear_gradient{
      color: #ff972e;
        }

    .linear_gradient1{
      color: #ff8000;
    }

    .card {
      margin: 20px;
      border-width: 3px;
      border-color: #ff8000;
    }

        
  </style>

  <body>
    <!-- ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
    <header class="mt-0">
      <nav class="navbar navbar-expand-md bg-body-tertiary">
        <div class="container-fluid">
          <a class="navbar-brand" href="../">
            <img src="../../static/asset/logo.png" alt="ë¡œê³ " style="max-height: 100px" />
          </a>
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarNav"
            aria-controls="navbarNav"
            aria-expanded="false"
            aria-label="Toggle navigation">

            <span class="navbar-toggler-icon">
              <i class="bi bi-list"></i>
            </span>
          </button>
        <div
            class="collapse navbar-collapse justify-content-end"
            id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="../recording/">ìŒì„± ë…¹ìŒí•˜ê¸°</a>
              </li>
              <!-- <li class="nav-item">
                      <a class="nav-link" href="./output.html"
                        >ìŒì„± ê°ì • ë¶„ì„ ê²°ê³¼</a
                      >
                    </li> -->
            <li class="nav-item">
                <a
                  class="nav-link"
                  active
                  aria-current="page"
                  href="./mypage.html/">ë§ˆì´í˜ì´ì§€</a>
            </li>
              <li class="nav-item">
                <a class="nav-link" id="logout" href = "../">ë¡œê·¸ì•„ì›ƒ</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>
    <!-- ë„¤ë¹„ê²Œì´ì…˜ ë°” ì½”ë“œ ë-->


    <!-- ë‚´ ì •ë³´ html ì½”ë“œ-->
        <div style="text-align: center;">
          <div class="linear_gradient" style="font-family: 'SBAggroB'; font-size:25px;">PROFILE</p></div>
        </div>
        <div style="text-align: center; margin: 5px;">
          <img src="../../static/asset/profile.png" height="150" width="150">
        </div>

        <div>
          <strong>
            <div style="font-size:20px; text-align: center;"  class="linear_gradient">
              {{ user.name }}
            </div>
            <div style="font-family: 'SBAggroB'; font-size:16px; text-align: center; margin-left: 30px; margin-right: 30px;" class="user_profile">
              ë‚˜ì´: {{user.age}}&nbsp;&nbsp;/ {{user.gender}}<br>
              ì§ì—…: {{user.occupation}}<br>
              {{user.email}}
            </div>
          </strong><br><br>

          <div style="font-family: 'SBAggroB'; font-size:18px; text-align: center; margin-left: 30px; margin-right: 30px;">
            Apple farmì€ ê°ì •ì„ 7ê°€ì§€ë¡œ ë¶„ë¥˜í•˜ì—¬ ê°ì •ë¶„ì„ì„ ì‹¤ì‹œí•˜ì˜€ìŠµë‹ˆë‹¤.<br>
            7ê°€ì§€ì˜ ê°ì •ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤<br><br>
            <strong class="linear_gradient1"> neutral, happy, sad, angry, fearful, disgust, surprised <br><br></strong>
            7ê°€ì§€ì˜ ê°ì •ë¹„ìœ¨ ì¤‘ ê°€ì¥ ë†’ì€ ë¹„ìœ¨ì„ ëŒ€í‘œì ì¸ ê°ì •ìœ¼ë¡œ ë½‘ì•˜ìŠµë‹ˆë‹¤.
          </div>
      <br><br>
<!-- ë‚´ ì •ë³´ html ì½”ë“œ ë-->


  
<div class="card">
  <p class="logs" style="font-family: 'SBAggroB'; font-size: 25px; margin: 10px">
    <span class="linear_gradient">ë¶„ì„ë‚´ì—­</span>ğŸ—‚ï¸
  </p>
  <div class="logs" style="font-size: 15px" style="font-family: 'SBAggroB'">
    {% if recordings %}
    <ul class="logs" style="font-family: 'SBAggroB'; font-size: 14px;">
      {% for recording in recordings %}
        <details>
          <summary style="background-color: #fff0e0;">
            <span class="linear_gradient">{{ recording.uploaded_at|date:"Y/m/d" }} &nbsp;&nbsp; </span>
            <strong>Emotion: </strong>
            <strong class="linear_gradient1">
              {% if recording.emotion_result %}
                {{ recording.emotion_result.emotion }}
              {% else %}
                ì—†ìŒ
              {% endif %}
            </strong>
            <p>Gender: <span  class="linear_gradient">{{ recording.gender }}</span> </p>
          </summary>
          <br>
          <br><br>
          <div style="text-align: center; font-size: 30px;">
            ì§€ê¸ˆ ë‚´ ê¸°ë¶„ì€<br>
          {% if recording.emotion_result %}
          {% if recording.emotion_result.emotion == 'happy' %}
            ğŸ˜„<br> í–‰ë³µí•´ìš”
          {% elif recording.emotion_result.emotion == 'sad' %}
            ğŸ˜¢<br> ìŠ¬í¼ìš”
          {% elif recording.emotion_result.emotion == 'angry' %}
            ğŸ˜¡<br> í™”ë‚˜ìš”
          {% elif recording.emotion_result.emotion == 'neutral' %}
            ğŸ˜¶<br> ì¤‘ë¦½ì´ì—ìš”
          {% elif recording.emotion_result.emotion == 'fearful' %}
            ğŸ˜±<br> ë¬´ì„œì›Œìš”
          {% elif recording.emotion_result.emotion == 'disgust' %}
            ğŸ¤¢<br> ì—­ê²¨ì›Œìš”
          {% elif recording.emotion_result.emotion == 'surprised' %}
            ğŸ˜§<br> ë†€ë¼ì›Œìš”
          {% else %}
            ì—†ìŒ
          {% endif %}
          {% endif %}
          </div>
          <br><br>
          <strong class="linear_gradient1" style="font-size: 20px;">[ê°ì • ë¹„ìœ¨ ê·¸ë˜í”„]</strong><br>
          <canvas id="chartContainer-{{ recording.id }}"></canvas>
          <script>
            var ratioString = '{{ recording.emotion_result.ratio|safe|escapejs|safe }}';
            var ratio = JSON.parse(ratioString.replace(/'/g, '"'));
            var data = Object.values(ratio);
            console.log(data)
            var labels = ['Neutral', 'Happy', 'Sad', 'Angry', 'Fearful', 'Disgust', 'Surprised'];
            var ctx = document.getElementById("chartContainer-{{ recording.id }}").getContext('2d');
            var myChart = new Chart(ctx, {
              type: 'doughnut',
              data: {
                labels: labels,
                datasets: [{
                  label: 'ê°ì • ë¹„ìœ¨',
                  data: data,
                  backgroundColor: [
                    'rgba(255, 255, 0, 0.2)',   // ë…¸ë‘ (neutral)
                    'rgba(255, 165, 0, 0.2)',   // ì£¼í™©
                    'rgba(0, 0, 255, 0.2)',     // íŒŒë‘ (sad)
                    'rgba(255, 0, 0, 0.2)',     // ë¹¨ê°• (ë²„ëŸ­)
                    'rgba(0, 128, 0, 0.2)',     // ì´ˆë¡
                    'rgba(0, 0, 128, 0.2)',     // ë‚¨ìƒ‰
                    'rgba(128, 0, 128, 0.2)',   // ë³´ë¼
                  ],
                  borderColor: [
                  'rgba(255, 255, 0, 0.2)',   // ë…¸ë‘ (neutral)
                    'rgba(255, 165, 0, 0.2)',   // ì£¼í™©
                    'rgba(0, 0, 255, 0.2)',     // íŒŒë‘ (sad)
                    'rgba(255, 0, 0, 0.2)',     // ë¹¨ê°• (ë²„ëŸ­)
                    'rgba(0, 128, 0, 0.2)',     // ì´ˆë¡
                    'rgba(0, 0, 128, 0.2)',     // ë‚¨ìƒ‰
                    'rgba(128, 0, 128, 0.2)',   // ë³´ë¼
                  ],
                  borderWidth: 1
                }]
              },
              options: {
                scales: {
                  y: {
                    beginAtZero: true
                  }
                }
              }
            });

          </script>
          <br>
                    <audio controls>
                      <source src="{{ recording.audio_file.url }}" type="audio/mpeg">
                      Your browser does not support the audio element.
                    </audio>
        <br><br><br>
        </details>
        <span>
        </span>
      {% endfor %}
    </ul>
    {% else %}
    <p class="logs">ë…¹ìŒ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.</p>
    {% endif %}
  </div>
</div>



    <!-- bootstrap js -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../static/js/navbar.js"></script>
</body>